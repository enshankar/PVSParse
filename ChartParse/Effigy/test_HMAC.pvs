test_HMAC  : THEORY
  BEGIN
    IMPORTING HMAC

    hexhmac16(key, message: hexstring): bytestring =
      hmac256(hex2bytestring(key), hex2bytestring(message), 64, 16)
 
    test16_0: bytestring =
      hexhmac16(
      "6f35628d65813435534b5d67fbdb54cb33403d04e843103e6399f806cb5df95febbdd61236f33245",
      "752cff52e4b90768558e5369e75d97c69643509a5e5904e0a386cbe4d0970ef73f918f675945a9aefe26daea27587e8dc909dd56fd0468805f834039b345f855cfe19c44b55af241fff3ffcd8045cd5c288e6c4e284c3720570b58e4d47b8feeedc52fd1401f698a209fccfa3b4c0d9a797b046a2759f82a54c41ccd7b5f592b")
      %05d1243e6465ed9620c9aec1c351a186

    test16_1: bytestring =
      hexhmac16(
      "17b52858e3e135be4440d7df0ca996f41ccb78b7d8cc1924d830fe81e0fd279c131ce3546303e95a",
      "e0eff00f3c46e96c8d5bd181283e4605348e3fa10b47945de3dcc159ae86e7bd3fdb13f2ada2c313fce6a69efa49a470689b1ef05aab778ae15dd35fe6fd1e3a59d351c68cf8f0ffd968d7e78b57377afcc9dce3fa5db1f06f6985c4414c0fcc780030f49fef791a6c08edc2a311080c373f00e4b2044a79d82860f0871bc259")
      %c4061427764f979468ac422891dea9ca

    test16_2: bytestring =
    hexhmac16(
    "7c67410e0a9e3d7ae4f3d04eff1c2716891e821c6ec1dc822142ce8d9949b1449a1a033a350f0ba8",
    "bfd166793abdcffbbd56df769150d1466c18a67af452c7e67f86ed741d163ebbd874b9d33a91d3671099620b6eddbbd0f31117164eb73ca201db59f1650131cbef5c7b1bb14089fd24da2919241fc9303c02def424ea861d88636bb90b13ebc38cf177f8a8b139e68082fa46bcfc428bd054c1bb7dd3ed7e9b86ed751736b6cc")
    %1a0d427e79a7bdca7b11579339d0ff77

    test16_3: bytestring =
    hexhmac16(
	"b2c450128d0744421c3f31fab37bbcdfb5a2ff2fb706d1f7e23c4886992c7d215c648ff8edb2eb59",
	"f6989ebb07aadaeef970f0b5ceb806ecffe77cc20f3c221a6659a9315dff5881961900e68efc320075edafd83de320c6f18f0892489af6d97a2effb252b76b9284ebaf6d42089c1e0a5cd509c20b86ff060d5362c1768f89fafaaf65f1b0fe656b1692984a567e1260c7499085b79f5fe7684779a25855f291c5a192637177c4")
	%f0d7c63677033ada0b502a4e95b20e43

    test16_4: bytestring =
    hexhmac16(
    "a7744321d73938b8eea13754909029881bbd727439fe2731b1c67b7083eb7b5d33adfcca65f5d189",
    "71299ca3daff2331082db370bdf8ceec227b71bdc49c3b14dc3fd213d3ba83e2058828ffc6414fd5a2c99891e9c85f316c5b9bdd810a067b4df97f7e4262acfee642e30ed6534b4a0b3b3eaf5d03f2b045ca5985e7bb45c7503cd03afc68fbea9bc09579141d5fb7cbea6d73208fcf913830715dff98401f6d708ef009b5b8cb")
    %f6302c5fd7c8495e233b5d6129f361da
    
    test16_5: bytestring =
    hexhmac16(
	"795a0ba9b02984cfce5e7395fb94d98fcf12ae5db8a06e239c9ad439bf42e523e65a31c3bdf356cd",
	"8b4aa20de6c1f051d11ad50ba2e4fc4ff1ec478455f9b5b96fb9893d2afca969402044c101ccb73c50e2b2dfeeae9690fb64222ab9c94fcd943078785fa8bed9e174ab6390bb16a29c8146cb2fd65a98f44de752d6b0e42f0af2c3df4f65e162742d201c1bf5d22bbee1daf8efc30d0ce491df2632173b8ad9e9b29b819cd8ac")
	%fbecae19c2ce766d286c8ce70133b669

    test16_6: bytestring =
    hexhmac16(
    "aa41b5222efdea882cbebd11d343000ec2ff6b2f7bbfa746158ea54f32d534ae31c7d3b7a5fcc373",
    "3274a0326682ba59d6c47db4164e3e9937bfad4199c6507101e5305aeb75d2bf22eb68558d59496f4c389fda04645f0676687f6757fc631b5bcc98cd947bc4d9fae8ddb14bb09a7f15f4270c105c1de0b25bb1abfeb52ce39d3f9baf2fe6c704e3f3670d458e95d158807f10e53d5f6d1221add336fa9211ecc7a1c767bfc286")

    test16_7: bytestring =
    hexhmac16(
    "aaa449923f0cd3e6a7e74d9c56a7eb6a3b4c3dea97e6a8400e5517fcff54ee4211b640280eee415f",
    "0486d2647e2cdf7bba36c8f3ff9e2941001c706eb1a44cbd582f638ee7be4482899c9ce07be4ac381d44fa4649004718e33ac273b1707b746d461a731986d12c93658f216908773aee4690af8eb0be275ecef122f7ac9c94859569d21b1f2bb24a6813eef19e28ca56c5f1f776b474b69a6165412b5f9766c7a5b6759491385c")

    hexhmac32(key, message: hexstring): bytestring =
      hmac256(hex2bytestring(key), hex2bytestring(message), 64, 32)

    test32_0: bytestring =
    hexhmac32(
    "726374c4b8df517510db9159b730f93431e0cd468d4f3821eab0edb93abd0fba46ab4f1ef35d54fec3d85fa89ef72ff3d35f22cf5ab69e205c10afcdf4aaf11338dbb12073474fddb556e60b8ee52f91163ba314303ee0c910e64e87fbf302214edbe3f2",
    "ac939659dc5f668c9969c0530422e3417a462c8b665e8db25a883a625f7aa59b89c5ad0ece5712ca17442d1798c6dea25d82c5db260cb59c75ae650be56569c1bd2d612cc57e71315917f116bbfa65a0aeb8af7840ee83d3e7101c52cf652d2773531b7a6bdd690b846a741816c860819270522a5b0cdfa1d736c501c583d916")
    %bd3d2df6f9d284b421a43e5f9cb94bc4ff88a88243f1f0133bad0fb1791f6569
   
    test32_1: bytestring =
    hexhmac32(
    "e245be9a9c8101263830ad3515c1c6cbf285a7e4b362ebc062cb8e7e75ef50ec4f315a9e09d9243d7109962253f26e23f847e1adedf2851405076e26a1f697062f048438f1fc26f80021ffd09068876975e4cda2e78261df82f672a390f534628ba58490",
    "425315dd8eccd17a84c1aa00ff72763f99ddcbc2c381b8b21567b2f8e263d1a210983d88263ae32fa7986ced9f596f4e7b05e5b71dc8de4930737308b9c4fc3defe783194d3c789ae55ba5b3f75665a7c23e11b69ae8bcfb3bf020955dffd705894acfd72a5bf885e7143f9830f1c010178d37066268b890dee7a1e5f69cccc1")
    %c5801d80a14391720e77eb7ffb1a0b21a16323641c9a312b05fdc34e90383c85

    test32_2: bytestring =
    hexhmac32(
    "7eb72f117b397cefcfb4e75ace3b081776e46b13521e93559d453e32ab74ebc0859b9a8dd4d1d39000ebe95f984d80a3f5004dc91a051dfbdfe9194f4f9a483e4e7955577fb0933464c63eaec771044d59abc3029a079519f8460a693b25b4ce207ae9d9",
    "4e6611a6d76395f2b0e23dcafcc672c090e7c00a5fb5e23d351f1f59a9b3da064d06641d2756146a656e9ab14cca90ee72fc52e12d4e10ca4ba9217203b59a6a2c422097ade7faef35e86a7d2c5d3eabe991a2c025a938a8af866bf462ec002155e3ed1d515d6f07881a573683c9a47e5d7057ae2f0d835dcb7ea4e7ad9e31b2")
    %531bb20800ceef736d52d323a01f91fed1b80457947b1f865d1f6b3b1102552f

    test32_3: bytestring =
    hexhmac32(
    "12720cff0ca649ff2e1c9355cba8020fc96dbe05af9fb4bc008d8d8ac8dee0fb741aa674e66def16c9a8d4e52289ad2a283c84165621c9a7bed046d0a05b56d43bd352f3e30d4d4854a501f246440872421f5054b3c0c91240096035597631bd10a2f8c3",
    "def8c9acee9d9f191419982551804a9a9411c7d1240b22243dc32fa5fef28b118353dcff4e6e5a5debae8f1dd3ba5a2c92023aa42598c942a642871a2bcdd989eba4526ca2a1308f37222a699c606906f7fcd444ffdb9042a834c71602e7a9be5e11b159b4dd2a98419df16f74197c100b261b197a7b7e0c8cc178014ce90297")
    %dc72f7049c66effcb820848059516c44f934ccb2ffca6f9f8f884e0e1c67eece

 
    test32_4: bytestring =
    hexhmac32(
    "83488a05032905754cc8fc569d37cae05f0c370db6acaafc56ca9a93982a4669ccaba6e3d184a19de4ce800bb643a360c14572aedb22974f0c966b859d91ad5d713b7ad99935794d2222570a3167733a532eda0b0eb17510bcb581e4995440101a00ee2e",
    "bd1170af91fdb2160db3522e1bc3b1a349d6e50479920ac5d9bedd8a16a787a3cdc2b6d24392f25555cc2f20b2ba9e6b47ddc96cfbd6df669d874ce21a758d3cf4704362ef7786d90ed67b01bd91299950058885accddbcf44e340ed4807864218653ee7ff7215aa1e176157a611f9374b984ad7f53ea70ab81be131062718ba")
    %6563097db04630821c814912828410d2cb056219f886786d6bf57a5b5b0083ea
    

   

  END test_HMAC
