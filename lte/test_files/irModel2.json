{
  "protocols":{
    "AKA":{
      "name":"AKA",
      "actors":{
        "UE":{
          "name":"UE",
          "funcs":[
            {
              "name":"K_AUSF",
              "arguments":[
                {
                  "node_type":"TypedTerm",
                  "term":{
                    "node_type":"AtomicTerm",
                    "name":"CK"
                  },
                  "typ":{
                    "node_type":"BitArray",
                    "size":128
                  }
                },
                {
                  "node_type":"TypedTerm",
                  "term":{
                    "node_type":"AtomicTerm",
                    "name":"SQN"
                  },
                  "typ":{
                    "node_type":"BitArray",
                    "size":48
                  }
                },
                {
                  "node_type":"TypedTerm",
                  "term":{
                    "node_type":"AtomicTerm",
                    "name":"AK"
                  },
                  "typ":{
                    "node_type":"BitArray",
                    "size":48
                  }
                },
                {
                  "node_type":"TypedTerm",
                  "term":{
                    "node_type":"AtomicTerm",
                    "name":"IK"
                  },
                  "typ":{
                    "node_type":"BitArray",
                    "size":128
                  }
                },
                {
                  "node_type":"TypedTerm",
                  "term":{
                    "node_type":"AtomicTerm",
                    "name":"serving_network_name"
                  },
                  "typ":{
                    "node_type":"TypePlaceholder$"
                  }
                }
              ],
              "statements":[
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#9636136fed0b9f8b44f7179de58b8bee",
                    "text":"The input key KEY shall be equal to the concatenation CK || IK of CK and IK."
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"Key"
                    },
                    "value":{
                      "node_type":"Concat",
                      "args":{
                        "node_type":"ConcreteList",
                        "members":[
                          {
                            "node_type":"AtomicTerm",
                            "name":"CK"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"IK"
                          }
                        ]
                      }
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#01672b41585fd36d196ff30bf52c89c5",
                    "text":"P0 = serving network  name;"
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"P0"
                    },
                    "value":{
                      "node_type":"AtomicTerm",
                      "name":"serving_network_name"
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#809c1b69d1063548780eed5715e1c9d0",
                    "text":"L0 = length of the serving network name (variable length as specified in 24.501  [35]);"
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"L0"
                    },
                    "value":{
                      "node_type":"LengthOf",
                      "arg":{
                        "node_type":"AtomicTerm",
                        "name":"serving_network_name"
                      }
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#8fe0d2231d5bfcd72b18c1c2facca86c",
                    "text":"FC =  0x6A;"
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"FC"
                    },
                    "value":{
                      "node_type":"Integer",
                      "value":106
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#b7c8e0a3096f9a58890f8d5aea072ae1",
                    "text":"P1 = SQN ⊕  AK,"
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"P1"
                    },
                    "value":{
                      "node_type":"Xor",
                      "args":{
                        "node_type":"ConcreteList",
                        "members":[
                          {
                            "node_type":"AtomicTerm",
                            "name":"SQN"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"AK"
                          }
                        ]
                      }
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#28f8e1ac526971f1bb3af3763e952fe3",
                    "text":"L1 = length of SQN ⊕ AK (i.e. 0x00 0x06)."
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"L1"
                    },
                    "value":{
                      "node_type":"LengthOf",
                      "arg":{
                        "node_type":"Xor",
                        "args":{
                          "node_type":"ConcreteList",
                          "members":[
                            {
                              "node_type":"AtomicTerm",
                              "name":"SQN"
                            },
                            {
                              "node_type":"AtomicTerm",
                              "name":"AK"
                            }
                          ]
                        }
                      }
                    }
                  }
                },
                {
                  "source":{
                    "document":"33501-h10_clean",
                    "section":"A.2",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#31d2e97d2b641231f2b1f167c8c2b453",
                    "text":"When deriving a K<sub>AUSF</sub> from CK, IK and the serving network name when producing authentication vectors, and when the UE computes K<sub>AUSF</sub> during 5G AKA, the following parameters shall be used to form the input S to the  KDF:"
                  },
                  "ir":{
                    "node_type":"Assign",
                    "variable":{
                      "node_type":"AtomicTerm",
                      "name":"S"
                    },
                    "value":{
                      "node_type":"Concat",
                      "args":{
                        "node_type":"ConcreteList",
                        "members":[
                          {
                            "node_type":"AtomicTerm",
                            "name":"FC"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"P0"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"L0"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"P1"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"L1"
                          }
                        ]
                      }
                    }
                  }
                },
                {
                  "source":{
                    "document":"33220-h00",
                    "section":"B.2.0",
                    "sentence_uid":"http://www.sri.com/effigy/3gpp#2a0fbc17d3c33b6154ca9ed91bed6d35",
                    "text":"derived key = HMAC-SHA-256 ( Key , S )"
                  },
                  "ir":{
                    "node_type":"Return",
                    "expr":{
                      "node_type":"Apply",
                      "func":{
                        "node_type":"AtomicTerm",
                        "name":"HMAC-SHA-256"
                      },
                      "args":{
                        "node_type":"ConcreteList",
                        "members":[
                          {
                            "node_type":"AtomicTerm",
                            "name":"Key"
                          },
                          {
                            "node_type":"AtomicTerm",
                            "name":"S"
                          }
                        ]
                      }
                    }
                  }
                }
              ]
            }
          ]
        }
      }
    }
  }
}
